[project]
name = "maestro"
version = "0.0.1"
description = "Automated bottleneck detection and solution orchestration"
authors = [
    { name = "Muhammad Awad", email = "muhaawad@amd.com" },
    { name = "Cole Ramos", email = "Cole.Ramos@amd.com" },
]

license = { text = "MIT" }
readme = "README.md"
requires-python = ">=3.8"

# Python dependencies 
dependencies = ["tomli", "openai>=1.0.0"]


[build-system]
requires = ["setuptools>=61.0"]
build-backend = "setuptools.build_meta"

[tool.rocprofiler-compute]
git = "git@github.com:ROCm/rocprofiler-compute.git"
branch = "41e73650d5cfc3dbd98e007d6279235578f8529a"
build_command = """
python3 -m pip install --ignore-installed blinker &&
python3 -m pip install -r requirements.txt
"""

[tool.guided-tuning]
git = "git@github.com:AMDResearch/guided-tuning.git"
branch = "629a237f90a8e1e7c21f4dabca14104cfb148614"
build_command = """
python3 -m pip install -r requirements.txt
"""


[tool.logduration]
git = "git@github.com:AMDResearch/logduration.git"
branch = "5caa4a4c4beefda6f357a72579b428d0dd152679"
build_command = """
git submodule update --init --recursive
#TODO: search for a Triton LLVM.
if [ -d "/root/.triton/llvm/llvm-ubuntu-x64" ]; then
    export TRITON_LLVM_PATH="/root/.triton/llvm/llvm-ubuntu-x64"
else
    export TRITON_LLVM_PATH="${ROCM_PATH}/llvm/"
fi
cmake -DCMAKE_PREFIX_PATH=${ROCM_PATH} \
      -DTRITON_LLVM=$TRITON_LLVM_PATH \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_VERBOSE_MAKEFILE=ON -S . -B build &&
cmake --build build --parallel 1
"""


[tool.nexus]
git = "git@github.com:AMDResearch/nexus.git"
branch = "main"
build_command = """
export CC=${ROCM_PATH}/bin/hipcc
export CXX=${ROCM_PATH}/bin/hipcc
cmake -B build -DCMAKE_PREFIX_PATH=/opt/rocm\
    -DLLVM_INSTALL_DIR=/opt/rocm/llvm\
    -DCMAKE_BUILD_TYPE=Debug
cmake --build build --parallel 16
"""

[project.optional-dependencies]
dev = ["black==25.1.0", "ruff==0.11.12"]


[tool.ruff]
line-length = 120

[tool.ruff.lint]
select = ["E", "F", "W"]
ignore = ["E501", "E701", "E731", "E741", "F841", "F401", "F811"]

[tool.ruff.format]
quote-style = "double"
